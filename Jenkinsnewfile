pipeline {

   agent any
   
    tools {
  maven 'maven'
   }
    stages {
        stage ('checkout') {
          steps {
            echo "this is checkout stage"
            checkout poll: false, scm: scmGit(branches: [[name: '*/main']], extensions: [], userRemoteConfigs: [[url: 'https://github.com/VenkatChekka/DemoProj.git']])
          }
        }
        stage ('Build') {
         agent {
            label "agentnode1"
           }
          steps {
            echo "This is Build Phase, Build Stage is in Progress"
            sh 'mvn compile'
           } 
        }
        stage ('Test') {
         agent {
            label "agentnode2"
          }
        steps {
           echo "This is test phase"
           sh 'mvn test'
           junit 'target/surefire-reports/*.xml'
          }
        }   
       stage ('Deploy') {
         agent {
            label "agentnode2"
          }
        steps {
           echo 'Deploying the Build'
          }
        }  
    }
}
